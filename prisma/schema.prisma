// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["fullTextSearch"]
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id            Int      @id @default(autoincrement())
    mail          String   @unique
    firstname     String
    lastname      String
    password      String
    type          Int
    society_code  Int      @default(00000)
    creation_date DateTime @default(now())
    creator       String
    color         String   @default("#696969")
    rooms         Room[]
    box           Box[]
    objects       Object[]
    Tag           Tag[]
}

model Room {
    id            Int      @id @default(autoincrement())
    name          String
    comment       String?
    creation_date DateTime @default(now())
    type          Int
    id_user       Int
    user          User     @relation(fields: [id_user], references: [id], onDelete: Cascade)
    box           Box[]
    Object        Object[]
}

model Box {
    id            Int        @id @default(autoincrement())
    name          String
    comment       String?
    creation_date DateTime   @default(now())
    empty         Boolean    @default(false)
    id_user       Int
    id_room       Int
    user          User       @relation(fields: [id_user], references: [id], onDelete: Cascade)
    room          Room       @relation(fields: [id_room], references: [id], onDelete: Cascade)
    objects       Object[]
    TagOnBox      TagOnBox[]
}

model Tag {
    id           Int        @id @default(autoincrement())
    name         String
    user         User       @relation(fields: [id_user], references: [id], onDelete: Cascade)
    id_user      Int
    society_code Int
    link         TagOnBox[]
}

model TagOnBox {
    box    Box @relation(fields: [id_box], references: [id], onDelete: Cascade)
    id_box Int
    tag    Tag @relation(fields: [id_tag], references: [id], onDelete: Cascade)
    id_tag Int

    @@id([id_box, id_tag])
}

model Object {
    id            Int      @id @default(autoincrement())
    name          String
    creation_date DateTime @default(now())
    id_user       Int
    id_box        Int
    id_room       Int
    user          User     @relation(fields: [id_user], references: [id], onDelete: Cascade)
    box           Box      @relation(fields: [id_box], references: [id], onDelete: Cascade)
    room          Room     @relation(fields: [id_room], references: [id], onDelete: Cascade)
}
